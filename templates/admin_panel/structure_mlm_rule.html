<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß MLM –°–¢–†–£–ö–¢–£–†–ê - –ë–ï–ó –ü–ï–†–ï–°–ï–ß–ï–ù–ò–ô</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: Arial, sans-serif;
            background: #f0f0f0;
            padding: 20px;
            overflow-x: auto;
        }
        
        .header {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2rem;
        }
        
        .status-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .status {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
            color: #155724;
        }
        
        .stats {
            background: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        
        .stat-item {
            text-align: center;
            margin: 5px;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #007bff;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        
        .btn {
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .btn.success {
            background: #28a745;
        }
        
        .btn.success:hover {
            background: #1e7e34;
        }
        
        .btn.warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn.warning:hover {
            background: #e0a800;
        }
        
        .structure-container {
            position: relative;
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            min-height: 1200px;
            width: 100%;
            overflow: auto;
            /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π */
            min-width: 4000px;
        }
        
        .node {
            position: absolute;
            background: #fff;
            border: 2px solid #ef4444;
            border-radius: 8px;
            padding: 12px 16px;
            text-align: center;
            min-width: 160px;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }
        
        .node:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .node.active {
            background: linear-gradient(145deg, #8b5cf6, #7c3aed);
            color: white;
            border-color: #7c3aed;
        }
        
        .node.level-0 {
            background: #e8f5e8;
            border-color: #28a745;
        }
        
        .node.level-1 {
            background: #fff3cd;
            border-color: #ffc107;
        }
        
        .node.level-2 {
            background: #d1ecf1;
            border-color: #17a2b8;
        }
        
        .node.level-3 {
            background: #f8d7da;
            border-color: #dc3545;
        }
        
        .node-name {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .node-level {
            font-size: 12px;
            color: #666;
        }
        
        .node.active .node-level {
            color: rgba(255, 255, 255, 0.8);
        }
        
        .connection-line {
            position: absolute;
            stroke: #3b82f6;
            stroke-width: 2;
            fill: none;
            z-index: 5;
            pointer-events: none;
        }
        
        .debug-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîß MLM –°–¢–†–£–ö–¢–£–†–ê - –ë–ï–ó –ü–ï–†–ï–°–ï–ß–ï–ù–ò–ô</h1>
    </div>
    
    <div class="status-container">
        <div class="status">
            ‚úÖ <strong>–°—Ç–∞—Ç—É—Å:</strong> –ë–ï–ó –ü–ï–†–ï–°–ï–ß–ï–ù–ò–ô! –ö–∞—Ä—Ç–æ—á–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è–º–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="totalNodes">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ —É–∑–ª–æ–≤</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="totalConnections">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Å–≤—è–∑–µ–π</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="level0Count">0</div>
                <div class="stat-label">–£—á–∞—Å—Ç–Ω–∏–∫–∏ (0-–π)</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="level1Count">0</div>
                <div class="stat-label">–ü–∞—Ä—Ç–Ω–µ—Ä—ã (1-–π)</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="level2Count">0</div>
                <div class="stat-label">–ü–∞—Ä—Ç–Ω–µ—Ä—ã (2-–π)</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="level3Count">0</div>
                <div class="stat-label">–ü–∞—Ä—Ç–Ω–µ—Ä—ã (3-–π)</div>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="renderStructure()">üîÑ –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å</button>
            <button class="btn warning" onclick="clearStructure()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
            <button class="btn success" onclick="addLevel0()">‚ûï –î–æ–±–∞–≤–∏—Ç—å 0-–π —É—Ä–æ–≤–µ–Ω—å</button>
            <button class="btn" onclick="testConnections()">üîó –¢–µ—Å—Ç —Å–≤—è–∑–µ–π</button>
            <button class="btn" onclick="showFullStructure()">üåê –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞</button>
        </div>
        
        <div class="debug-info" id="debugInfo">
            üîç –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–ï–ó –ü–ï–†–ï–°–ï–ß–ï–ù–ò–ô...
        </div>
    </div>
    
    <div class="structure-container" id="structureContainer">
        <!-- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
    </div>

    <script>
        console.log('üîß MLM No Intersections Loading - NO OVERLAPS!');
        
        function updateDebugInfo(message) {
            const debugInfo = document.getElementById('debugInfo');
            if (debugInfo) {
                debugInfo.textContent = message;
                console.log('üîç Debug:', message);
            }
        }
        
        function updateStats() {
            const stats = {
                total: 0,
                connections: 0,
                level0: 0,
                level1: 0,
                level2: 0,
                level3: 0
            };
            
            function countNodes(node) {
                stats.total++;
                if (node.level === 0) stats.level0++;
                else if (node.level === 1) stats.level1++;
                else if (node.level === 2) stats.level2++;
                else if (node.level === 3) stats.level3++;
                
                if (node.children) {
                    stats.connections += node.children.length;
                    node.children.forEach(child => countNodes(child));
                }
            }
            
            countNodes(structure);
            
            document.getElementById('totalNodes').textContent = stats.total;
            document.getElementById('totalConnections').textContent = stats.connections;
            document.getElementById('level0Count').textContent = stats.level0;
            document.getElementById('level1Count').textContent = stats.level1;
            document.getElementById('level2Count').textContent = stats.level2;
            document.getElementById('level3Count').textContent = stats.level3;
        }
        
        // MLM –°–¢–†–£–ö–¢–£–†–ê –ë–ï–ó –ü–ï–†–ï–°–ï–ß–ï–ù–ò–ô –° –£–í–ï–õ–ò–ß–ï–ù–ù–´–ú–ò –†–ê–°–°–¢–û–Ø–ù–ò–Ø–ú–ò
        let structure = {
            id: 'plazma',
            name: 'PLAZMA',
            level: 4,
            x: 2000,
            y: 50,
            children: [
                {
                    id: '3-1',
                    name: '3*/1',
                    level: 3,
                    x: 1000,
                    y: 200,
                    children: [
                        {
                            id: '2-1',
                            name: '2*/1',
                            level: 2,
                            x: 600,
                            y: 350,
                            children: [
                                { id: '1-1', name: '1*/1', level: 1, x: 300, y: 500 },
                                { id: '1-2', name: '1*/2', level: 1, x: 600, y: 500 },
                                { id: '1-3', name: '1*/3', level: 1, x: 900, y: 500 }
                            ]
                        },
                        {
                            id: '2-2',
                            name: '2*/2',
                            level: 2,
                            x: 1000,
                            y: 350,
                            children: [
                                { id: '1-4', name: '1*/4', level: 1, x: 700, y: 500 },
                                { id: '1-5', name: '1*/5', level: 1, x: 1000, y: 500 },
                                { id: '1-6', name: '1*/6', level: 1, x: 1300, y: 500 }
                            ]
                        },
                        {
                            id: '2-3',
                            name: '2*/3',
                            level: 2,
                            x: 1400,
                            y: 350,
                            children: [
                                { id: '1-7', name: '1*/7', level: 1, x: 1100, y: 500 },
                                { id: '1-8', name: '1*/8', level: 1, x: 1400, y: 500 },
                                { id: '1-9', name: '1*/9', level: 1, x: 1700, y: 500 }
                            ]
                        }
                    ]
                },
                {
                    id: '3-2',
                    name: '3*/2',
                    level: 3,
                    x: 2000,
                    y: 200,
                    children: [
                        {
                            id: '2-4',
                            name: '2*/4',
                            level: 2,
                            x: 1600,
                            y: 350,
                            children: [
                                { id: '1-10', name: '1*/10', level: 1, x: 1300, y: 500 },
                                { id: '1-11', name: '1*/11', level: 1, x: 1600, y: 500 },
                                { id: '1-12', name: '1*/12', level: 1, x: 1900, y: 500 }
                            ]
                        },
                        {
                            id: '2-5',
                            name: '2*/5',
                            level: 2,
                            x: 2000,
                            y: 350,
                            children: [
                                { id: '1-13', name: '1*/13', level: 1, x: 1700, y: 500 },
                                { id: '1-14', name: '1*/14', level: 1, x: 2000, y: 500 },
                                { id: '1-15', name: '1*/15', level: 1, x: 2300, y: 500 }
                            ]
                        },
                        {
                            id: '2-6',
                            name: '2*/6',
                            level: 2,
                            x: 2400,
                            y: 350,
                            children: [
                                { id: '1-16', name: '1*/16', level: 1, x: 2100, y: 500 },
                                { id: '1-17', name: '1*/17', level: 1, x: 2400, y: 500 },
                                { id: '1-18', name: '1*/18', level: 1, x: 2700, y: 500 }
                            ]
                        }
                    ]
                },
                {
                    id: '3-3',
                    name: '3*/3',
                    level: 3,
                    x: 3000,
                    y: 200,
                    children: [
                        {
                            id: '2-7',
                            name: '2*/7',
                            level: 2,
                            x: 2600,
                            y: 350,
                            children: [
                                { id: '1-19', name: '1*/19', level: 1, x: 2300, y: 500 },
                                { id: '1-20', name: '1*/20', level: 1, x: 2600, y: 500 },
                                { id: '1-21', name: '1*/21', level: 1, x: 2900, y: 500 }
                            ]
                        },
                        {
                            id: '2-8',
                            name: '2*/8',
                            level: 2,
                            x: 3000,
                            y: 350,
                            children: [
                                { id: '1-22', name: '1*/22', level: 1, x: 2700, y: 500 },
                                { id: '1-23', name: '1*/23', level: 1, x: 3000, y: 500 },
                                { id: '1-24', name: '1*/24', level: 1, x: 3300, y: 500 }
                            ]
                        },
                        {
                            id: '2-9',
                            name: '2*/9',
                            level: 2,
                            x: 3400,
                            y: 350,
                            children: [
                                { id: '1-25', name: '1*/25', level: 1, x: 3100, y: 500 },
                                { id: '1-26', name: '1*/26', level: 1, x: 3400, y: 500 },
                                { id: '1-27', name: '1*/27', level: 1, x: 3700, y: 500 }
                            ]
                        }
                    ]
                }
            ]
        };
        
        function renderNode(node) {
            console.log('üéØ Rendering node:', node.name, 'at', node.x, node.y);
            
            const nodeElement = document.createElement('div');
            nodeElement.className = `node ${node.level === 4 ? 'active' : `level-${node.level}`}`;
            nodeElement.id = `node-${node.id}`;
            nodeElement.style.left = `${node.x}px`;
            nodeElement.style.top = `${node.y}px`;
            nodeElement.innerHTML = `
                <div class="node-name">${node.name}</div>
                <div class="node-level">${node.level}*/${node.id.split('-')[1] || '1'}</div>
            `;
            
            const container = document.getElementById('structureContainer');
            if (container) {
                container.appendChild(nodeElement);
                console.log('‚úÖ Node added to container');
            } else {
                console.error('‚ùå Container not found!');
            }
        }
        
        function renderConnection(parentId, childId) {
            const parent = findNodeById(structure, parentId);
            const child = findNodeById(structure, childId);
            
            if (!parent || !child) {
                console.log('‚ùå Parent or child not found:', parentId, childId);
                return;
            }
            
            console.log(`üîó Connecting ${parentId} to ${childId}`);
            
            const pX = parent.x + 80;
            const pY = parent.y + 40;
            const cX = child.x + 80;
            const cY = child.y;
            
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path.setAttribute('stroke', '#3b82f6');
            path.setAttribute('stroke-width', '2');
            path.setAttribute('fill', 'none');
            path.setAttribute('class', 'connection-line');
            path.setAttribute('d', `M ${pX} ${pY} L ${cX} ${cY}`);
            
            let svg = document.getElementById('connection-svg');
            if (!svg) {
                svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.setAttribute('id', 'connection-svg');
                svg.style.position = 'absolute';
                svg.style.top = '0';
                svg.style.left = '0';
                svg.style.width = '100%';
                svg.style.height = '100%';
                svg.style.pointerEvents = 'none';
                svg.style.zIndex = '1';
                document.getElementById('structureContainer').appendChild(svg);
            }
            
            svg.appendChild(path);
            console.log('‚úÖ Connection line added');
        }
        
        function findNodeById(root, id) {
            if (root.id === id) return root;
            if (root.children) {
                for (let child of root.children) {
                    const found = findNodeById(child, id);
                    if (found) return found;
                }
            }
            return null;
        }
        
        function renderStructure() {
            console.log('üé® Rendering no intersections structure...');
            updateDebugInfo('–ù–∞—á–∏–Ω–∞–µ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–ï–ó –ü–ï–†–ï–°–ï–ß–ï–ù–ò–ô...');
            
            const container = document.getElementById('structureContainer');
            if (!container) {
                console.error('‚ùå Container not found!');
                return;
            }
            
            container.innerHTML = '';
            
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.setAttribute('id', 'connection-svg');
            svg.style.position = 'absolute';
            svg.style.top = '0';
            svg.style.left = '0';
            svg.style.width = '100%';
            svg.style.height = '100%';
            svg.style.pointerEvents = 'none';
            svg.style.zIndex = '1';
            container.appendChild(svg);
            
            function renderNodeRecursive(node) {
                renderNode(node);
                if (node.children) {
                    node.children.forEach(child => renderNodeRecursive(child));
                }
            }
            
            function renderConnectionsRecursive(node) {
                if (node.children) {
                    node.children.forEach(child => {
                        renderConnection(node.id, child.id);
                        renderConnectionsRecursive(child);
                    });
                }
            }
            
            renderNodeRecursive(structure);
            renderConnectionsRecursive(structure);
            
            updateStats();
            
            updateDebugInfo(`‚úÖ –°–¢–†–£–ö–¢–£–†–ê –ë–ï–ó –ü–ï–†–ï–°–ï–ß–ï–ù–ò–ô –≥–æ—Ç–æ–≤–∞! –£–∑–ª–æ–≤: ${document.getElementById('totalNodes').textContent}, –°–≤—è–∑–µ–π: ${document.getElementById('totalConnections').textContent} - –ë–ï–ó –ù–ê–õ–û–ñ–ï–ù–ò–ô!`);
            console.log('‚úÖ No intersections structure rendered successfully - NO OVERLAPS!');
        }
        
        function clearStructure() {
            const container = document.getElementById('structureContainer');
            container.innerHTML = '';
            updateStats();
            updateDebugInfo('üóëÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—á–∏—â–µ–Ω–∞');
        }
        
        function testConnections() {
            updateDebugInfo('üîó –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–≤—è–∑–∏...');
            
            const plazma = findNodeById(structure, 'plazma');
            const node3_1 = findNodeById(structure, '3-1');
            const node2_1 = findNodeById(structure, '2-1');
            const node1_1 = findNodeById(structure, '1-1');
            
            updateDebugInfo(`üîó –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω. PLAZMA: ${plazma ? '‚úÖ' : '‚ùå'}, 3-1: ${node3_1 ? '‚úÖ' : '‚ùå'}, 2-1: ${node2_1 ? '‚úÖ' : '‚ùå'}, 1-1: ${node1_1 ? '‚úÖ' : '‚ùå'}`);
        }
        
        function addLevel0() {
            updateDebugInfo('‚ûï –î–æ–±–∞–≤–ª—è–µ–º 0-–π —É—Ä–æ–≤–µ–Ω—å...');
            
            function addLevel0Recursive(node) {
                if (node.level === 1) {
                    if (!node.children) {
                        node.children = [];
                    }
                    
                    for (let i = 1; i <= 3; i++) {
                        const level0Id = `0-${node.id.split('-')[1]}-${i}`;
                        const level0Node = {
                            id: level0Id,
                            name: `0*/${level0Id.split('-')[1]}${i}`,
                            level: 0,
                            x: node.x + (i - 2) * 300,
                            y: node.y + 150
                        };
                        node.children.push(level0Node);
                    }
                } else if (node.children) {
                    node.children.forEach(child => addLevel0Recursive(child));
                }
            }
            
            addLevel0Recursive(structure);
            renderStructure();
            updateDebugInfo('‚úÖ 0-–π —É—Ä–æ–≤–µ–Ω—å –¥–æ–±–∞–≤–ª–µ–Ω!');
        }
        
        function showFullStructure() {
            updateDebugInfo('üåê –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É...');
            
            // –†–∞—Å—à–∏—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ –ø–æ–ª–Ω–æ–π MLM
            function expandToFullMLM(node) {
                if (node.level === 1 && (!node.children || node.children.length < 3)) {
                    if (!node.children) node.children = [];
                    
                    for (let i = node.children.length + 1; i <= 3; i++) {
                        const childId = `0-${node.id.split('-')[1]}-${i}`;
                        const child = {
                            id: childId,
                            name: `0*/${node.id.split('-')[1]}${i}`,
                            level: 0,
                            x: node.x + (i - 2) * 300,
                            y: node.y + 150
                        };
                        node.children.push(child);
                    }
                } else if (node.children) {
                    node.children.forEach(child => expandToFullMLM(child));
                }
            }
            
            expandToFullMLM(structure);
            renderStructure();
            updateDebugInfo('‚úÖ –ü–æ–ª–Ω–∞—è MLM —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞!');
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìÑ DOM Content Loaded - NO INTERSECTIONS');
            updateDebugInfo('DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –Ω–∞—á–∏–Ω–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–ï–ó –ü–ï–†–ï–°–ï–ß–ï–ù–ò–ô...');
            renderStructure();
        });
        
        setTimeout(function() {
            console.log('‚è∞ Delayed initialization - NO INTERSECTIONS');
            updateDebugInfo('–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–ï–ó –ü–ï–†–ï–°–ï–ß–ï–ù–ò–ô...');
            renderStructure();
        }, 100);
    </script>
</body>
</html>
